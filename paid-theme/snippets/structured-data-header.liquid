<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "name": {{ shop.name | json }},
    {%- if section.settings.logo %}
      "logo": {{ section.settings.logo | image_url: width: section.settings.logo.width | prepend: "https:" | json }},
    {%- endif %}
    {% capture sameAs_json %}
      {%- if settings.social_facebook_url != blank -%}
        {{ settings.social_facebook_url | json }},
      {%- endif -%}
      {%- if settings.social_youtube_url != blank -%}
        {{ settings.social_youtube_url | json }},
      {%- endif -%}
      {%- if settings.social_instagram_url != blank -%}
        {{ settings.social_instagram_url | json }},
      {%- endif -%}
      {%- if settings.social_whatsapp_url != blank -%}
        {{ settings.social_whatsapp_url | json }},
      {%- endif -%}
      {%- if settings.social_tiktok_url != blank -%}
        {{ settings.social_tiktok_url | json }},
      {%- endif -%}
      {%- if settings.social_snapchat_url != blank -%}
        {{ settings.social_snapchat_url | json }},
      {%- endif -%}
      {%- if settings.social_pinterest_url != blank -%}
        {{ settings.social_pinterest_url | json }},
      {%- endif -%}
      {%- if settings.social_twitter_url != blank -%}
        {{ settings.social_twitter_url | json }},
      {%- endif -%}
      {%- if settings.social_linkedin_url != blank -%}
        {{ settings.social_linkedin_url | json }},
      {%- endif -%}
      {%- if settings.social_wechat_url != blank -%}
        {{ settings.social_wechat_url | json }},
      {%- endif -%}
      {%- if settings.social_vimeo_url != blank -%}
        {{ settings.social_vimeo_url | json }},
      {%- endif -%}
      {%- if settings.social_tumblr_url != blank -%}
        {{ settings.social_tumblr_url | json }},
      {%- endif -%}
      {%- if settings.social_twitch_url != blank -%}
        {{ settings.social_twitch_url | json }},
      {%- endif -%}
      {%- if settings.social_spotify_url != blank -%}
        {{ settings.social_spotify_url | json }},
      {%- endif -%}
      {%- if settings.social_discord_url != blank -%}
        {{ settings.social_discord_url | json }},
      {%- endif -%}
      {%- if settings.social_mastodon_url != blank -%}
        {{ settings.social_mastodon_url | json }},
      {%- endif -%}
      {%- if settings.social_threads_url != blank -%}
        {{ settings.social_threads_url | json }},
      {%- endif -%}
      {%- if settings.social_custom_url != blank -%}
        {{ settings.social_custom_url | json }},
      {%- endif -%}
    {% endcapture %}
    "sameAs": [
      {{ sameAs_json | remove_last: ',' }}
    ],
    "url": {{ shop.url | append: page.url | json }}
  }
</script>

    {%- if request.page_type == 'collection' and collection != blank and collection.products_count > 0 -%}
      {%- capture item_list -%}
        {
          "@context": "https://schema.org",
          "@type": "ItemList",
          "name": {{ collection.title | json }},
          "numberOfItems": {{ collection.products_count }},
          "itemListElement": [
            {%- for product in collection.products limit: 30 -%}
              {
                "@type": "ListItem",
                "position": {{ forloop.index }},
                "url": {{ shop.url | append: product.url | json }},
                "name": {{ product.title | json }}
              }{%- unless forloop.last -%},{%- endunless -%}
            {%- endfor -%}
          ]
        }
      {%- endcapture -%}
      <script type="application/ld+json">{{ item_list | strip_newlines }}</script>
    {%- endif -%}

    {%- if request.page_type == 'product' and product != blank -%}
      {%- capture product_sd -%}
        {
          "@context": "https://schema.org",
          "@type": "Product",
          "name": {{ product.title | json }},
          "url": {{ shop.url | append: product.url | json }},
          {%- if product.featured_media -%}
          "image": [{{ product.featured_media | image_url: width: 800 | prepend: 'https:' | json }}],
          {%- endif -%}
          "sku": {{ product.selected_or_first_available_variant.sku | json }},
          "brand": {"@type":"Brand","name": {{ product.vendor | json }}},
          "offers": {
            "@type": "Offer",
            "priceCurrency": {{ cart.currency.iso_code | json }},
            "price": {{ product.price | money_without_currency | replace: ',', '' | json }},
            "availability": "https://schema.org/{% if product.available %}InStock{% else %}OutOfStock{% endif %}",
            "url": {{ shop.url | append: product.url | json }}
          }
        }
      {%- endcapture -%}
      <script type="application/ld+json">{{ product_sd | strip_newlines }}</script>
    {%- endif -%}

{%- if request.page_type == 'index' -%}
  {%- assign potential_action_target = shop.url | append: routes.search_url | append: "?q={search_term_string}" -%}
  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "WebSite",
      "name": {{ shop.name | json }},
      "url": {{ shop.url | append: page.url | json }},
      "potentialAction": {
        "@type": "SearchAction",
        "target": {{ potential_action_target | json }},
        "query-input": "required name=search_term_string"
      }
    }
  </script>
{%- endif -%}
